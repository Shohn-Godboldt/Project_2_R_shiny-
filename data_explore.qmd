---
title: "Static Data Exploration — Seoul Bike (Kaggle)"
author: Shohn Godboldt
format:
  html:
    toc: true
    toc-depth: 2
    theme: cosmo
    code-fold: true
execute:
  echo: true
  warning: false
  message: false
---
## Introduction

This report provides a static, reproducible exploration of the Seoul Bike Sharing Kaggle dataset. 
It mirrors the functionality of the Shiny app by showing categorical tables, numeric summaries, and 
a plot set (≥6 plots, ≥4 multivariate, ≥1 faceted, ≥1 novel).

**Dataset:** *Seoul Bike Sharing Demand Prediction* (Kaggle).  
**Unit of observation:** hour-level weather/operational records with `rented_bike_count`.

## Data Source & Variables

Key variables used here:

- **Categorical:** `seasons`, `holiday`, `functioning_day`
- **Numeric:** `rented_bike_count`, `temperature_c`, `humidity`, `wind_speed_m_s`, `visibility_10m`

We convert `date` to Date and coerce the above categoricals to factors for tidy summaries/plots.

```{r}
library(readr); library(dplyr); library(tidyr); library(ggplot2); library(janitor)
library(forcats); library(stringr); library(purrr); library(scales)

# Read with UTF-8 locale to avoid "invalid UTF-8" warnings

df <- readr::read_csv(
  "data/SeoulBikeData.csv",
  show_col_types = FALSE,
  locale = readr::locale(encoding = "UTF-8")
) |> janitor::clean_names()

df <- df %>%
  mutate(
    date = suppressWarnings(as.Date(date, format = "%d/%m/%Y")),
    seasons = as.factor(seasons),
    holiday = as.factor(holiday),
    functioning_day = as.factor(functioning_day)
  )
# --- STANDARDIZE & NUMERIC COERCION (add this AFTER mutate) --------------------
# Some Kaggle copies have "humidity_" after clean_names(); rename if needed.
if ("humidity_" %in% names(df) && !"humidity" %in% names(df)) {
  df <- dplyr::rename(df, humidity = humidity_)
}

# Force key numerics to numeric (in case readr guessed character for any)
num_cols <- c(
  "rented_bike_count","temperature_c","humidity","wind_speed_m_s",
  "visibility_10m","dew_point_temperature_c","solar_radiation_mj_m2",
  "rainfall_mm","snowfall_cm","hour"
)
df <- df %>%
  mutate(across(all_of(intersect(names(df), num_cols)),
                ~ suppressWarnings(as.numeric(.))))

# --- Find & standardize humidity column ---------------------------------------
# Look for any column that starts with "humidity" after clean_names()
hum_col <- dplyr::first(names(df)[grepl("^humidity", names(df))])

if (is.na(hum_col)) {
  # Helpful diagnostic so you can see what's available
  print(names(df))
  stop("No humidity-like column found. Check the printed names and update the pattern.")
}

# Create a consistent numeric column for plotting
df <- df %>%
  mutate(humidity_std = suppressWarnings(as.numeric(.data[[hum_col]])))

```

## Structure

```{r}
glimpse(df)
summary(df)
```

## Categorical Summaries

### One-way table
We show counts by a single categorical variable (default: `seasons`).
Cross-tabulation of seasons × functioning_day, with row/column totals.
```{r}
one_way_var <- "seasons"
df %>%
  count(.data[[one_way_var]]) %>%
  arrange(desc(n)) %>%
  janitor::adorn_totals(name = "Total")

df %>%
count(seasons, functioning_day) %>%
tidyr::pivot_wider(names_from = functioning_day,
values_from = n, values_fill = 0) %>%
janitor::adorn_totals(where = c("row","col"))


```

## Numeric Summaries by Group

We summarize the distribution of rented_bike_count within each level of `seasons`.

```{r}
num_summary_var <- "rented_bike_count"
group_var <- "seasons"
df %>%
  group_by(.data[[group_var]]) %>%
  summarise(
    n = n(),
    mean = mean(.data[[num_summary_var]], na.rm = TRUE),
    sd = sd(.data[[num_summary_var]], na.rm = TRUE),
    median = median(.data[[num_summary_var]], na.rm = TRUE),
    min = min(.data[[num_summary_var]], na.rm = TRUE),
    max = max(.data[[num_summary_var]], na.rm = TRUE),
    .groups = "drop"
  )

```

## Plots (≥6 total; ≥4 multivariate; ≥1 faceted; ≥1 novel)

```{r}
# Safety: make sure ggplot2 is attached for the plot chunks below
if (!"package:ggplot2" %in% search()) {
  library(ggplot2)
}
```

### 1) Scatter — Temperature vs Rentals (multivariate: color = seasons)
```{r}
ggplot(df, aes(x = temperature_c, y = rented_bike_count, color = seasons)) +
  geom_point(alpha = 0.6) +
  labs(title = "Rentals vs Temperature by Season",
       x = "Temperature (°C)", y = "Rented Bike Count",
       color = "Season")
```

### 2) Boxplot- Rentals by Season (Multivariate)
```{r}
ggplot(df, aes(x = seasons, y = rented_bike_count, fill = seasons)) +
geom_boxplot(outlier.alpha = 0.4) +
labs(title = "Rented Bike Count by Season", x = "Season", y = "Rented Bike Count", fill = "Season")
```

### 3) Histogram- Rentals faceted by Functioning Day (FACETED)
```{r}
ggplot(df, aes(x = rented_bike_count)) +
geom_histogram(bins = 30) +
facet_wrap(vars(functioning_day)) +
labs(title = "Distribution of Rentals (Faceted by Functioning Day)",
x = "Rented Bike Count", y = "Frequency")
```

### 4) Mean Bar- Mean Rentals by Holiday (Multivariate via Fill)
```{r}
df %>%
group_by(holiday) %>%
summarise(mean_rentals = mean(rented_bike_count, na.rm = TRUE)) %>%
ggplot(aes(x = holiday, y = mean_rentals, fill = holiday)) +
geom_col() +
labs(title = "Mean Rented Bike Count by Holiday", x = "Holiday", y = "Mean Rentals", fill = "Holiday")
```

### 5) Denisty- Temperature by Season (Multivariate via color)
```{r}
ggplot(df, aes(x = temperature_c, color = seasons)) +
geom_density() +
labs(title = "Temperature Density by Season", x = "Temperature (°C)", y = "Density", color = "Season")
```

### 6) Novel- 2D density heatmap (temperature vs Humidity)
```{r}
ggplot(df, aes(x = temperature_c, y = humidity_std)) +
  stat_bin2d(bins = 30) +
  labs(title = "2D Density Heatmap: Temperature vs Humidity",
       x = "Temperature (°C)", y = "Humidity (%)")

```

## Brief Findings

From the six plots and summary tables above, we can make several observations:

- **Temperature and Rentals:** Warmer temperatures generally correspond with higher bike rentals, showing clear seasonal influence.
- **Seasonal Trends:** Summer and Autumn show the highest average rentals, while Winter is the lowest.
- **Holiday Effect:** Mean rentals are noticeably lower on holidays, indicating reduced commuter activity.
- **Functioning Days:** Faceted histograms show that non-functioning days (likely maintenance or closures) drastically reduce rentals.
- **Humidity Relationship:** The 2D heatmap shows moderate humidity levels are most common when rentals are high—extreme humidity or dryness correlates with fewer rentals.

Overall, rentals increase in warmer, clear-weather conditions and decline during colder or less favorable weather or non-functioning periods.

## Reproducibility Notes

- Data source: *Seoul Bike Sharing Demand Prediction* dataset from Kaggle.  
- Data loaded from `data/SeoulBikeData.csv` using UTF-8 encoding.  
- All transformations and visualizations executed in R using the following packages:  
  `tidyverse`, `janitor`, `scales`, and `ggplot2`.  
- The Quarto document (`data_explore.qmd`) and Shiny app (`app.R`) together mirror each other what is seen here in the quarto document can be manipulated in the Shiny app as well.  
- The full workflow is reproducible on any R environment (≥4.2) with these packages installed.

